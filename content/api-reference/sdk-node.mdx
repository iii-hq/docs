---
title: "Node.js SDK"
description: "API reference for the iii SDK for Node.js / TypeScript."
---

## Installation

```bash
npm install iii-sdk
```

## Initialization

The Node.js SDK exports an `init` function that creates a connected SDK instance. The WebSocket connection is established automatically — there is no separate `connect()` call.

```typescript
import { init } from 'iii-sdk'

const iii = init(process.env.III_BRIDGE_URL ?? 'ws://localhost:49134', {
  workerName: 'my-worker',
})
```

<ResponseField name="init" type="(address: string, options?: InitOptions) => ISdk" required>
  Creates and returns a connected SDK instance.

  <AccordionGroup>
    <Accordion iconName="Settings" title="InitOptions" description="">
      <ResponseField name="workerName" type="string">
        Display name for this worker. Defaults to `hostname:pid`.
      </ResponseField>
      <ResponseField name="invocationTimeoutMs" type="number">
        Default timeout for `call()` in milliseconds. Defaults to `30000`.
      </ResponseField>
      <ResponseField name="enableMetricsReporting" type="boolean">
        Enable worker metrics via OpenTelemetry. Defaults to `true`.
      </ResponseField>
      <ResponseField name="reconnectionConfig" type="Partial&lt;IIIReconnectionConfig&gt;">
        WebSocket reconnection behavior.

        <Expandable title="IIIReconnectionConfig">
          <ResponseField name="initialDelayMs" type="number">
            Starting delay in milliseconds. Default `1000`.
          </ResponseField>
          <ResponseField name="maxDelayMs" type="number">
            Maximum delay cap in milliseconds. Default `30000`.
          </ResponseField>
          <ResponseField name="backoffMultiplier" type="number">
            Exponential backoff multiplier. Default `2`.
          </ResponseField>
          <ResponseField name="jitterFactor" type="number">
            Random jitter factor (0–1). Default `0.3`.
          </ResponseField>
          <ResponseField name="maxRetries" type="number">
            Maximum retry attempts. `-1` for infinite. Default `-1`.
          </ResponseField>
        </Expandable>
      </ResponseField>
      <ResponseField name="otel" type="Omit&lt;OtelConfig, 'engineWsUrl'&gt;">
        OpenTelemetry configuration. Enabled by default. Set `{ enabled: false }` or env `OTEL_ENABLED=false` to disable.
      </ResponseField>
    </Accordion>
  </AccordionGroup>
</ResponseField>

## Methods

### registerFunction

<ResponseField name="registerFunction" type="(func: RegisterFunctionInput, handler: RemoteFunctionHandler) => FunctionRef" required>
  Registers a function with the engine. The `id` is the unique identifier used by triggers and invocations.

  <AccordionGroup>
    <Accordion iconName="Settings" title="Parameters" description="">
      <ResponseField name="func" type="RegisterFunctionInput" required>
        <Expandable title="RegisterFunctionInput">
          <ResponseField name="id" type="string" required>
            Unique function identifier.
          </ResponseField>
          <ResponseField name="description" type="string">
            Human-readable description.
          </ResponseField>
        </Expandable>
      </ResponseField>
      <ResponseField name="handler" type="(data: TInput) => Promise&lt;TOutput&gt;" required>
        Async function that processes the invocation payload.
      </ResponseField>
    </Accordion>
    <Accordion iconName="ArrowUpRight" title="Returns" description="">
      <ResponseField name="FunctionRef" type="FunctionRef">
        ```typescript
        type FunctionRef = {
          id: string
          unregister: () => void
        }
        ```
      </ResponseField>
    </Accordion>
    <Accordion iconName="Code" title="Example" description="">
      ```typescript
      const fn = iii.registerFunction(
        { id: 'greet', description: 'Greets a user' },
        async (input: { name: string }) => {
          return { message: `Hello, ${input.name}!` }
        },
      )
      ```
    </Accordion>
  </AccordionGroup>
</ResponseField>

### registerTrigger

<ResponseField name="registerTrigger" type="(trigger: RegisterTriggerInput) => Trigger" required>
  Binds a trigger configuration to a registered function.

  <AccordionGroup>
    <Accordion iconName="Settings" title="Parameters" description="">
      <ResponseField name="trigger" type="RegisterTriggerInput" required>
        <Expandable title="RegisterTriggerInput">
          <ResponseField name="type" type="string" required>
            Trigger type (e.g. `http`, `queue`, `cron`).
          </ResponseField>
          <ResponseField name="function_id" type="string" required>
            ID of the function to invoke.
          </ResponseField>
          <ResponseField name="config" type="unknown" required>
            Trigger-specific configuration.
          </ResponseField>
        </Expandable>
      </ResponseField>
    </Accordion>
    <Accordion iconName="ArrowUpRight" title="Returns" description="">
      <ResponseField name="Trigger" type="Trigger">
        ```typescript
        type Trigger = {
          unregister(): void
        }
        ```
      </ResponseField>
    </Accordion>
    <Accordion iconName="Code" title="Example" description="">
      ```typescript
      iii.registerTrigger({
        type: 'http',
        function_id: 'greet',
        config: { api_path: '/greet', http_method: 'GET' },
      })
      ```
    </Accordion>
  </AccordionGroup>
</ResponseField>

### registerService

<ResponseField name="registerService" type="(service: RegisterServiceInput) => void" required>
  Registers a service. A service groups related functions under a common namespace.

  <AccordionGroup>
    <Accordion iconName="Settings" title="Parameters" description="">
      <ResponseField name="service" type="RegisterServiceInput" required>
        <Expandable title="RegisterServiceInput">
          <ResponseField name="id" type="string" required>
            Unique service identifier.
          </ResponseField>
          <ResponseField name="description" type="string">
            Human-readable description.
          </ResponseField>
        </Expandable>
      </ResponseField>
    </Accordion>
  </AccordionGroup>
</ResponseField>

### call

<ResponseField name="call" type="&lt;TInput, TOutput&gt;(function_id: string, data: TInput, timeoutMs?: number) => Promise&lt;TOutput&gt;" required>
  Invokes a remote function and waits for the result.

  <AccordionGroup>
    <Accordion iconName="Settings" title="Parameters" description="">
      <ResponseField name="function_id" type="string" required>
        ID of the function to invoke.
      </ResponseField>
      <ResponseField name="data" type="TInput" required>
        Payload to pass to the function.
      </ResponseField>
      <ResponseField name="timeoutMs" type="number">
        Override the default invocation timeout.
      </ResponseField>
    </Accordion>
    <Accordion iconName="ArrowUpRight" title="Returns" description="">
      <ResponseField name="result" type="Promise&lt;TOutput&gt;">
        The value returned by the remote function.
      </ResponseField>
    </Accordion>
  </AccordionGroup>
</ResponseField>

### callVoid

<ResponseField name="callVoid" type="&lt;TInput&gt;(function_id: string, data: TInput) => void" required>
  Fire-and-forget invocation. No response is expected.

  <AccordionGroup>
    <Accordion iconName="Settings" title="Parameters" description="">
      <ResponseField name="function_id" type="string" required>
        ID of the function to invoke.
      </ResponseField>
      <ResponseField name="data" type="TInput" required>
        Payload to pass to the function.
      </ResponseField>
    </Accordion>
  </AccordionGroup>
</ResponseField>

### createStream

<ResponseField name="createStream" type="&lt;TData&gt;(streamName: string, stream: IStream&lt;TData&gt;) => void" required>
  Registers a custom stream implementation, overriding the engine default for the given stream name.

  <AccordionGroup>
    <Accordion iconName="Settings" title="Parameters" description="">
      <ResponseField name="streamName" type="string" required>
        Name of the stream.
      </ResponseField>
      <ResponseField name="stream" type="IStream&lt;TData&gt;" required>
        Object implementing `get`, `set`, `delete`, `list`, `listGroups`, and `update`.
      </ResponseField>
    </Accordion>
  </AccordionGroup>
</ResponseField>

### onFunctionsAvailable

<ResponseField name="onFunctionsAvailable" type="(callback: FunctionsAvailableCallback) => () => void" required>
  Subscribes to function availability events from the engine. Returns an unsubscribe function.
</ResponseField>

### onLog

<ResponseField name="onLog" type="(callback: LogCallback, config?: LogConfig) => () => void" required>
  Subscribes to OTEL log events from the engine. Returns an unsubscribe function.

  <AccordionGroup>
    <Accordion iconName="Settings" title="LogConfig" description="">
      <ResponseField name="level" type="LogSeverityLevel">
        Minimum severity: `trace`, `debug`, `info`, `warn`, `error`, `fatal`, or `all`. Default `all`.
      </ResponseField>
    </Accordion>
  </AccordionGroup>
</ResponseField>

### listFunctions

<ResponseField name="listFunctions" type="() => Promise&lt;FunctionInfo[]&gt;" required>
  Lists all functions registered with the engine.
</ResponseField>

### listWorkers

<ResponseField name="listWorkers" type="() => Promise&lt;WorkerInfo[]&gt;" required>
  Lists all connected workers.
</ResponseField>

### getConnectionState

<ResponseField name="getConnectionState" type="() => IIIConnectionState" required>
  Returns the current WebSocket connection state: `disconnected`, `connecting`, `connected`, `reconnecting`, or `failed`.
</ResponseField>

### onConnectionStateChange

<ResponseField name="onConnectionStateChange" type="(callback: ConnectionStateCallback) => () => void" required>
  Subscribes to connection state changes. The callback fires immediately with the current state, then on each transition. Returns an unsubscribe function.
</ResponseField>

### shutdown

<ResponseField name="shutdown" type="() => Promise&lt;void&gt;" required>
  Gracefully shuts down the SDK: flushes telemetry, rejects pending invocations, and closes the WebSocket.
</ResponseField>

### registerTriggerType

<ResponseField name="registerTriggerType" type="&lt;TConfig&gt;(triggerType: RegisterTriggerTypeInput, handler: TriggerHandler&lt;TConfig&gt;) => void" required>
  Registers a custom trigger type with the engine.

  <AccordionGroup>
    <Accordion iconName="Settings" title="Parameters" description="">
      <ResponseField name="triggerType" type="RegisterTriggerTypeInput" required>
        <Expandable title="RegisterTriggerTypeInput">
          <ResponseField name="id" type="string" required>
            Unique trigger type identifier.
          </ResponseField>
          <ResponseField name="description" type="string" required>
            Human-readable description.
          </ResponseField>
        </Expandable>
      </ResponseField>
      <ResponseField name="handler" type="TriggerHandler&lt;TConfig&gt;" required>
        ```typescript
        type TriggerHandler<TConfig> = {
          registerTrigger(config: TriggerConfig<TConfig>): Promise<void>
          unregisterTrigger(config: TriggerConfig<TConfig>): Promise<void>
        }
        ```

        <Expandable title="TriggerConfig">
          <ResponseField name="id" type="string" required>
            Trigger instance ID.
          </ResponseField>
          <ResponseField name="function_id" type="string" required>
            Function to invoke when the trigger fires.
          </ResponseField>
          <ResponseField name="config" type="TConfig" required>
            Trigger-specific configuration.
          </ResponseField>
        </Expandable>
      </ResponseField>
    </Accordion>
  </AccordionGroup>
</ResponseField>

### unregisterTriggerType

<ResponseField name="unregisterTriggerType" type="(triggerType: RegisterTriggerTypeInput) => void" required>
  Unregisters a previously registered trigger type.
</ResponseField>

## Subpath Exports

The `iii-sdk` package provides additional entry points:

| Import path | Contents |
|---|---|
| `iii-sdk` | `init`, `getContext`, `withContext`, `Logger`, `ISdk`, `ApiRequest`, `ApiResponse` |
| `iii-sdk/stream` | `IStream` and all stream types (`StreamGetInput`, `StreamSetInput`, `UpdateOp`, etc.) |
| `iii-sdk/state` | State management types |
| `iii-sdk/telemetry` | OpenTelemetry utilities (`initOtel`, `getTracer`, `getMeter`, `withSpan`, etc.) |

## Types

```typescript
type ApiRequest<TBody = unknown> = {
  path_params: Record<string, string>
  query_params: Record<string, string | string[]>
  body: TBody
  headers: Record<string, string | string[]>
  method: string
}

type ApiResponse<
  TStatus extends number = number,
  TBody = string | Buffer | Record<string, unknown>,
> = {
  status_code: TStatus
  headers?: Record<string, string>
  body: TBody
}

type FunctionRef = {
  id: string
  unregister: () => void
}

type Trigger = {
  unregister(): void
}

type IIIConnectionState =
  | 'disconnected'
  | 'connecting'
  | 'connected'
  | 'reconnecting'
  | 'failed'
```

## Context

```typescript
import { getContext } from 'iii-sdk'

const ctx = getContext()
ctx.logger.info('Processing started')
```

The `getContext()` function returns the current `Context` (with `logger` and `trace`) from within a function handler.
